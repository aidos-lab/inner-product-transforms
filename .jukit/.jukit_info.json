{"cmd": "%load_ext autoreload\n%autoreload 2\nimport pyvista as pv\nimport torch\n\nfrom src.transforms.affine import Transform, TransformConfig\n\nconfig = TransformConfig(\n    mean_mean=(0.9, 0.7, 0.9),\n    mean_std=(0.1, -0.1, 0.1),\n    scale_mean=.5,\n    scale_std=.5,\n    max_scale=.1,\n)\n\n\ntr = Transform(config)\n\n\n# Make spheres\npcs = torch.randn(32, 1000, 3)\npcs /= pcs.norm(dim=-1, keepdim=True)\n\nspheres = tr(pcs)\n\nprint(spheres.norm(dim=-1).max())\n\nplotter = pv.Plotter(shape=(2,2))\n\nplotter.subplot(0,0)\nfor i in range(1):\n    plotter.add_points(\n        points=pcs[i].cpu().numpy(),\n        render_points_as_spheres=True,\n        point_size=3,\n    )\nplotter.subplot(1,0)\nfor i in range(1):\n    plotter.add_points(\n        points=spheres[i].cpu().numpy(),\n        render_points_as_spheres=True,\n        point_size=3,\n    )\n\nplotter.link_views()\nplotter.show()\n", "cmd_opts": " --cell_id=NONE -s", "import_complete": 1, "terminal": "nvimterm"}